<!-- src/app/perfil/perfil.component.html -->

<div class="container mx-auto p-4 max-w-lg">

  <h2 class="text-2xl font-semibold mb-4">Editar mi perfil</h2>

  <!-- Mensaje de error general -->
  <div *ngIf="errorGeneral" class="bg-red-100 text-red-700 p-2 rounded mb-4">
    {{ errorGeneral }}
  </div>

  <!-- Spinner mientras carga -->
  <div *ngIf="cargando" class="text-center py-8">
    <svg class="animate-spin h-8 w-8 text-gray-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
    </svg>
    <p class="mt-2 text-gray-600">Cargando...</p>
  </div>

  <!-- Formulario de edición -->
  <form *ngIf="!cargando" [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">

    <!-- Correo Electrónico -->
    <div>
      <label class="block text-sm font-medium text-gray-700">Correo electrónico</label>
      <input
        formControlName="correoElectronico"
        type="email"
        class="mt-1 block w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300"
        placeholder="tucorreo@ejemplo.com"
      />
      <div class="mt-1 text-sm text-red-500" *ngIf="correoElectronicoControl.touched && correoElectronicoControl.invalid">
        <p *ngIf="correoElectronicoControl.hasError('required')">El correo es obligatorio.</p>
        <p *ngIf="correoElectronicoControl.hasError('email')">Formato inválido. Ej.: usuario&#64;dominio.com</p>
        <p *ngIf="correoElectronicoControl.hasError('pattern')">El correo debe ser .com, .gt, etc.</p>
      </div>
    </div>

    <!-- Teléfono -->
    <div>
      <label class="block text-sm font-medium text-gray-700">Teléfono</label>
      <input
        formControlName="telefono"
        type="text"
        class="mt-1 block w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300"
        placeholder="8 dígitos"
      />
      <div class="mt-1 text-sm text-red-500" *ngIf="telefonoControl.touched && telefonoControl.invalid">
        <p *ngIf="telefonoControl.hasError('required')">El teléfono es obligatorio.</p>
        <p *ngIf="telefonoControl.hasError('pattern')">Debe tener exactamente 8 dígitos.</p>
      </div>
    </div>

    <!-- Botón Guardar -->
    <div class="flex justify-end">
      <button
        type="submit"
        [disabled]="form.invalid"
        class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm
               font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none
               focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"
      >
        Guardar cambios
      </button>
    </div>
  </form>

</div>
